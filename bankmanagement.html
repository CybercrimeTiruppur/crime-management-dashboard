<script>
    let banks = [];

    function loadBanks() {
        fetch('banks.json')
            .then(response => response.json())
            .then(data => {
                banks = data;
                const tableBody = document.getElementById('bankTable').getElementsByTagName('tbody')[0];
                tableBody.innerHTML = ''; // Clear existing rows

                banks.forEach((bank, index) => {
                    const row = tableBody.insertRow();
                    row.insertCell(0).innerText = bank.name;
                    row.insertCell(1).innerText = bank.email;
                    const actionsCell = row.insertCell(2);
                    actionsCell.innerHTML = `<button onclick="editBank(${index})">Modify</button>
                                             <button onclick="deleteBank(${index})">Delete</button>`;
                });
            })
            .catch(error => console.error('Error loading banks:', error));
    }

    function addBank() {
        const name = prompt("Enter bank name:");
        const email = prompt("Enter bank email:");
        if (name && email) {
            banks.push({ name, email });
            loadBanks(); // Refresh the table to show the new bank
            saveBanks(); // Save the updated list to the server
        } else {
            console.error("Name and Email are required");
        }
    }

    function editBank(index) {
        const name = prompt("Edit bank name:", banks[index].name);
        const email = prompt("Edit bank email:", banks[index].email);
        if (name && email) {
            banks[index] = { name, email };
            loadBanks();
            saveBanks();
        }
    }

    function deleteBank(index) {
        if (confirm("Are you sure you want to delete this bank?")) {
            banks.splice(index, 1);
            loadBanks();
            saveBanks();
        }
    }

    function saveBanks() {
        fetch('update_banks.php', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(banks)
        })
        .then(response => {
            console.log('Response status:', response.status);
            return response.text(); // Use text() to see the raw response
        })
        .then(data => {
            console.log('Response data:', data);
            try {
                const jsonData = JSON.parse(data);
                console.log('Parsed JSON:', jsonData);
            } catch (error) {
                console.error('Error parsing JSON:', error);
            }
        })
        .catch(error => console.error('Error:', error));
    }

    // Initial load
    loadBanks();
</script>
